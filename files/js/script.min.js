window.FOS=window.FOS||{},FOS.region=FOS.region||{},FOS.region.imageSlider=FOS.region.imageSlider||{},FOS.region.imageSlider.initSlider=function(config,initJs){apex.debug.info("FOS - Image Slider: ",config),config.watchSlidesProgress=!0,config.speed=300,config.spaceBetween=0,config.breakPoints={},initJs&&"function"==typeof initJs&&initJs.call(this,config);const CSS_PREFIX="fos-image-slider",ICON_FULLSCREEN_IS_ON="fa-compress",ICON_FULLSCREEN_IS_OFF="fa-expand",SLIDE_CHANGE_EVENT="fos-imageslider-slide-change",FULLSCREEN_ENTER_EVENT="fos-imageslider-fullscreen-enter",FULLSCREEN_EXIT_EVENT="fos-imageslider-fullscreen-exit",SLIDE_CLICK_EVENT="fos-imageslider-slide-click";let regionId=config.regionId,regionEl=document.querySelector(`#${regionId}`),sliderContainerEl=regionEl.querySelector(`.${CSS_PREFIX}-container`),fullscreenBtn,swiper,thumbsSwiper,{width:width=800,height:height=500,autoplay:autoplay,delaySecs:delaySecs,imagesPerRegion:imagesPerRegion=1,pagination:pagination,hidePaginationOnClick:hidePaginationOnClick,navigation:navigation,hideNavigationOnClick:hideNavigationOnClick,thumbnailsEnabled:thumbnailsEnabled,fullscreenSupport:fullscreenSupport,thumbnails:thumbnails=5,loop:loop,transition:transition="slide",direction:direction="horizontal",imageSize:imageSize="cover",imageSizeCustom:imageSizeCustom,pluginUri:pluginUri,pageItemsToSubmit:pageItemsToSubmit,requestType:requestType}=config,swiperCfg={observer:!0,observeSlideChildren:!0,keyboard:{enabled:!0,onlyInViewport:!0},lazy:{loadPrevNext:!0,checkInView:!0},loop:loop,slidesPerView:parseInt(imagesPerRegion)||1,effect:"slide"!=transition&&transition,direction:direction,initialSlide:0},regionStyle="";if(pageItemsToSubmit=pageItemsToSubmit||"",width&&(regionStyle+="width:"+("number"==typeof width?`${width}px`:width)+";"),height&&(regionStyle+="height:"+("number"==typeof height?`${height}px`:height)+";"),regionEl.setAttribute("style",regionStyle),autoplay&&(swiperCfg.autoplay={delay:1e3*parseFloat(delaySecs),disableOnInteraction:!1,pauseOnMouseEnter:!0}),pagination&&(swiperCfg.pagination={el:sliderContainerEl.querySelector(".swiper-pagination"),clickable:!0,hideOnClick:hidePaginationOnClick}),navigation&&(swiperCfg.navigation={nextEl:sliderContainerEl.querySelector(".swiper-button-next"),prevEl:sliderContainerEl.querySelector(".swiper-button-prev"),hideOnClick:hideNavigationOnClick}),fullscreenSupport&&(fullscreenBtn=sliderContainerEl.querySelector(`.${CSS_PREFIX}-fullscreen-btn`),sliderContainerEl.addEventListener("fullscreenchange",fullscreenHandler),fullscreenBtn.addEventListener("click",fullscreenBtnClickHandler)),thumbnailsEnabled){let thumbsEl=sliderContainerEl.querySelector(`.${CSS_PREFIX}-thumbnails`);thumbsSwiper=new Swiper(thumbsEl,{observer:!0,observeSlideChildren:!0,spaceBetween:6,slidesPerView:0==thumbnails?"auto":parseInt(thumbnails),watchSlidesVisibility:!0,watchSlidesProgress:!0,autoplay:!1,loop:!1}),swiperCfg.thumbs={swiper:thumbsSwiper}}function fullscreenBtnClickHandler(e){document.fullscreenElement?document.exitFullscreen():sliderContainerEl.requestFullscreen().catch(err=>{console.warn(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`)})}function fullscreenHandler(e){let cl=fullscreenBtn.firstElementChild.classList;document.fullscreenElement?(cl.remove("fa-expand"),cl.add("fa-compress"),triggerEvent(FULLSCREEN_ENTER_EVENT,{swiper:swiper})):(cl.remove("fa-compress"),cl.add("fa-expand"),triggerEvent(FULLSCREEN_EXIT_EVENT,{swiper:swiper}))}function triggerEvent(eventName,paramsObj){apex.event.trigger(`#${regionId}`,eventName,paramsObj)}function updateImageSlider(){apex.message.clearErrors(),swiper.removeAllSlides(),thumbsSwiper&&thumbsSwiper.removeAllSlides(),apex.server.plugin(pluginUri,{x02:requestType,pageItems:pageItemsToSubmit.split(",").map(id=>id.trim()).map(id=>`#${id}`).join(",")},{dataType:"json",success:function(jsonData){apex.debug.getLevel()!=apex.debug.LOG_LEVEL.OFF&&apex.debug.info(`${CSS_PREFIX} jsonData: ${jsonData}`);for(let i=0;i<jsonData.result.length;i++){const element=jsonData.result[i];swiper.addSlide(i,`\n                                <div class="swiper-slide swiper-lazy" data-background="${element}">\n                                <div class="swiper-lazy-preloader"></div>\n                            `),thumbsSwiper&&thumbsSwiper.addSlide(i,`\n                                    <div class="swiper-slide ${CSS_PREFIX}-thumbnail-slide" \n                                        style="background-image:url(${element})">\n                                    </div>\n                                `)}swiper.update(),thumbsSwiper&&thumbsSwiper.update(),sliderContainerEl.querySelectorAll(`.${CSS_PREFIX}-gallery .swiper-slide`).forEach(el=>{el.style.backgroundSize="custom"==imageSize?imageSizeCustom+"%":imageSize}),jsonData.result.length>0&&swiper.slideTo(0)},error:function(xhr,ajaxOptions,thrownError){apex.debug.getLevel()!=apex.debug.LOG_LEVEL.OFF&&(apex.debug.error(`${CSS_PREFIX} ajaxOptions: ${ajaxOptions}`),apex.debug.error(`${CSS_PREFIX} thrownError: ${thrownError}`)),apex.message.showErrors([{type:"error",location:"page",message:xhr.responseText,unsafe:!1}]),swiper.update(),thumbsSwiper.update()}})}swiperCfg.slidesPerView>1&&(swiperCfg.speed=config.speed,swiperCfg.spaceBetween=config.spaceBetween,swiperCfg.watchSlidesProgress=config.watchSlidesProgress,swiperCfg.breakpoints=config.breakPoints),swiper=new Swiper(sliderContainerEl.querySelector(`.${CSS_PREFIX}-gallery`),swiperCfg),sliderContainerEl.querySelectorAll(`.${CSS_PREFIX}-gallery .swiper-slide`).forEach(el=>{el.style.backgroundSize="custom"==imageSize?imageSizeCustom+"%":imageSize}),swiper.on("slideChange",_=>{let index=swiper.activeIndex;triggerEvent(SLIDE_CHANGE_EVENT,{index:index,swiper:swiper})}),swiper.on("click",(swiper,event)=>{triggerEvent(SLIDE_CLICK_EVENT,event.target)}),apex.region.create(regionId,{slideNext(speed=300,runCallbacks=!0){swiper.slideNext(speed,runCallbacks)},slidePrev(speed=300,runCallbacks=!0){swiper.slidePrev(speed,runCallbacks)},slideTo(index,speed=300,runCallbacks=!0){swiper.slideTo(index,speed,runCallbacks)},getGallerySlider:()=>swiper,getThumbnailsSlider:()=>thumbsSwiper,stopAutoplay(){swiper.autoplay&&swiper.autoplay.stop()},isAutoplayRunning:()=>swiper.autoplay.running,startAutoplay(){swiper.autoplay&&swiper.autoplay.start()},refresh(){updateImageSlider()}})};